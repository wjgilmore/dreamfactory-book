<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Chapter 4. How to Secure Your REST APIs | Getting Started with DreamFactory</title>
    <meta name="description" content="This chapter explains how DreamFactory can secure your APIs using a variety of solutions, including basic HTTP authentication, LDAP, Active Directory, OpenID Connect, and Okta.">
    
    <meta name="name" content="How to Secure Your REST APIs">
    <link rel="preload" href="/assets/css/styles.6b877e42.css" as="style"><link rel="preload" href="/assets/js/app.6b877e42.js" as="script"><link rel="preload" href="/assets/js/13.b04c4acb.js" as="script"><link rel="prefetch" href="/assets/css/1.styles.8e8fe409.css"><link rel="prefetch" href="/assets/css/2.styles.84ac1af2.css"><link rel="prefetch" href="/assets/js/1.8e8fe409.js"><link rel="prefetch" href="/assets/js/10.ca9d12b5.js"><link rel="prefetch" href="/assets/js/11.861d1b83.js"><link rel="prefetch" href="/assets/js/12.9c48f79a.js"><link rel="prefetch" href="/assets/js/14.62efffa9.js"><link rel="prefetch" href="/assets/js/15.511338a8.js"><link rel="prefetch" href="/assets/js/16.143d7088.js"><link rel="prefetch" href="/assets/js/17.a18439bb.js"><link rel="prefetch" href="/assets/js/18.f7adc784.js"><link rel="prefetch" href="/assets/js/19.2d5f81c5.js"><link rel="prefetch" href="/assets/js/2.84ac1af2.js"><link rel="prefetch" href="/assets/js/20.7b6f240b.js"><link rel="prefetch" href="/assets/js/21.ec248db7.js"><link rel="prefetch" href="/assets/js/22.85b9630b.js"><link rel="prefetch" href="/assets/js/23.1b8fb598.js"><link rel="prefetch" href="/assets/js/24.b0779a1f.js"><link rel="prefetch" href="/assets/js/25.14eba55b.js"><link rel="prefetch" href="/assets/js/26.b1fcbd94.js"><link rel="prefetch" href="/assets/js/27.db190eae.js"><link rel="prefetch" href="/assets/js/28.e09c5e9a.js"><link rel="prefetch" href="/assets/js/29.4ee53634.js"><link rel="prefetch" href="/assets/js/3.46f1d2e5.js"><link rel="prefetch" href="/assets/js/30.b45780c6.js"><link rel="prefetch" href="/assets/js/31.54d1433d.js"><link rel="prefetch" href="/assets/js/32.050d1408.js"><link rel="prefetch" href="/assets/js/33.bdbc6cbc.js"><link rel="prefetch" href="/assets/js/34.cd0b60f3.js"><link rel="prefetch" href="/assets/js/35.d56f0ae2.js"><link rel="prefetch" href="/assets/js/36.389d1861.js"><link rel="prefetch" href="/assets/js/37.b7458b15.js"><link rel="prefetch" href="/assets/js/4.4b26f617.js"><link rel="prefetch" href="/assets/js/5.c74c5e46.js"><link rel="prefetch" href="/assets/js/6.721c9c65.js"><link rel="prefetch" href="/assets/js/7.cdf6cda6.js"><link rel="prefetch" href="/assets/js/8.86acf750.js"><link rel="prefetch" href="/assets/js/9.be6b1000.js">
    <link rel="stylesheet" href="/assets/css/1.styles.8e8fe409.css"><link rel="stylesheet" href="/assets/css/2.styles.84ac1af2.css"><link rel="stylesheet" href="/assets/css/styles.6b877e42.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/mark-white.png" alt="Getting Started with DreamFactory" class="logo"> <span class="site-name can-hide">Getting Started with DreamFactory</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://www.dreamfactory.com/contact" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contact
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.dreamfactory.com/contact" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sales
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://genie.dreamfactory.com/register" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Free Hosted Trial
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://www.dreamfactory.com/contact" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Contact
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://www.dreamfactory.com/contact" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sales
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://genie.dreamfactory.com/register" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Free Hosted Trial
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Chapter 4. How to Secure Your REST APIs</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/docs/chapter04.html#authenticating-with-basic-http-authentication" class="sidebar-link">Authenticating with Basic HTTP Authentication</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/chapter04.html#authenticating-with-openid-connect" class="sidebar-link">Authenticating with OpenID Connect</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/chapter04.html#configuring-openid-connect" class="sidebar-link">Configuring OpenID Connect</a></li><li class="sidebar-sub-header"><a href="/docs/chapter04.html#configuring-dreamfactory" class="sidebar-link">Configuring DreamFactory</a></li><li class="sidebar-sub-header"><a href="/docs/chapter04.html#the-openid-authentication-process" class="sidebar-link">The OpenID Authentication Process</a></li></ul></li><li><a href="/docs/chapter04.html#authenticating-with-okta" class="sidebar-link">Authenticating with Okta</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/chapter04.html#configuring-okta" class="sidebar-link">Configuring OKTA</a></li><li class="sidebar-sub-header"><a href="/docs/chapter04.html#configuring-dreamfactory-2" class="sidebar-link">Configuring DreamFactory</a></li></ul></li><li><a href="/docs/chapter04.html#adding-okta-users-to-the-dreamfactory-application" class="sidebar-link">Adding Okta Users to the DreamFactory Application</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="chapter-4-how-to-secure-your-rest-apis"><a href="#chapter-4-how-to-secure-your-rest-apis" aria-hidden="true" class="header-anchor">#</a> Chapter 4. How to Secure Your REST APIs</h1> <p>One of DreamFactory's most popular features is the wide-ranging authentication support. While API Key-based authentication is suffice for many DreamFactory-powered applications, developers often require a higher degree of security through user-specific authentication. In some cases <a href="http://wiki.dreamfactory.com/DreamFactory/Tutorials/Basic_Auth" target="_blank" rel="noopener noreferrer">Basic HTTP authentication<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> will get the job done, however many enterprises require more sophisticated and flexible approaches largely because of the growing adoption of Single Sign On (SSO)-based solutions such as Active Directory and LDAP, and use of third-party identity providers and solutions such as <a href="https://aws.amazon.com/cognito/" target="_blank" rel="noopener noreferrer">AWS Cognito<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, <a href="https://auth0.com/" target="_blank" rel="noopener noreferrer">Auth0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, and <a href="https://www.okta.com/" target="_blank" rel="noopener noreferrer">Okta<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>You'll be pleased to know DreamFactory supports all of these options through a comprehensive set of authentication connectors. These connectors include Active Directory, LDAP, OAuth through well-known identity providers such as Facebook, GitHub, and Twitter, OpenID Connect, and SAML 2.0. In this chapter we'll walk you through all of the different authentication integration options at your disposal!</p> <h2 id="authenticating-with-basic-http-authentication"><a href="#authenticating-with-basic-http-authentication" aria-hidden="true" class="header-anchor">#</a> Authenticating with Basic HTTP Authentication</h2> <p>[Section Forthcoming]</p> <blockquote><p>GET /api/v2/mysql/_table/employees HTTP/1.1
Host: demo.dreamfactory.com
User-Agent: insomnia/6.6.0
Authorization: Basic d2pAd2pnaWxtb3JlLmNvbTpqYXNvbjEyMw==
Accept: <em>/</em></p></blockquote> <h2 id="authenticating-with-openid-connect"><a href="#authenticating-with-openid-connect" aria-hidden="true" class="header-anchor">#</a> Authenticating with OpenID Connect</h2> <p>OpenID affords users the convenience of using an existing account for signing into different websites. Not only does this eliminate the need to juggle multiple passwords, but OpenID also gives users greater control over what personal information is shared with websites that support OpenID. OpenID has been widely adopted since its inception in 2005, with companies such as Google, Microsoft, and Facebook offering OpenID provider services. Additionally, several OpenID libraries are available for integrating with these providers. Commercial editions of DreamFactory (versions 2.7 and newer) also support OpenID, allowing you to use OpenID-based authentication in conjunction with your APIs.</p> <h3 id="configuring-openid-connect"><a href="#configuring-openid-connect" aria-hidden="true" class="header-anchor">#</a> Configuring OpenID Connect</h3> <p>To configure DreamFactory's OpenID connector, you'll first need to identify an OpenID provider. This provider manages the credentials your users will use for authentication purposes. For the purposes of this tutorial we'll use <a href="https://developers.google.com/identity/protocols/OpenIDConnect" target="_blank" rel="noopener noreferrer">Google's OpenID implementation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. If you want to follow along with this specific example you'll first need to login to <a href="https://console.developers.google.com" target="_blank" rel="noopener noreferrer">Google's API Console<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to create a set of OAuth2 credentials. After logging in, use the search field at the top of the screen to search for <code>OAuth</code>. In the dropdown that appears choose <code>Credentials</code> (see below screenshot).</p> <p><img src="/images/04/openid/google-search.png" width="600"></p> <p>Next, click on the <code>Create credentials</code> dropdown and select <code>OAuth client ID</code>:</p> <p><img src="/images/04/openid/google-create-credentials.png" width="600"></p> <p>Next you'll be prompted to configure your consent screen. This is the screen the user sees when initiating the authentication process. Click <code>Configure consent screen</code>, and you'll be prompted to add or confirm the following items:</p> <ul><li><strong>Application type</strong>: Will this OpenID integration be used solely for users of your organization, or could users outside of your organization also use it to authenticate?</li> <li><strong>Application name</strong>: The name of the application associated with OpenID integration.</li> <li><strong>Application logo</strong>: You can optionally upload your organization or project logo for presentation on the consent screen.</li> <li><strong>Support email</strong>: An organizational e-mail address which the user could contact with questions and issues.</li> <li><strong>Scopes for Google APIs</strong>: This settings determines what data your application will be able to access on behalf of the authenticated user. We'll use the default scopes for this example (email, profile, and openid).</li> <li><strong>Privacy policy URL</strong>: Self-explanatory</li> <li><strong>Terms of service URL</strong>: Self-explanatory</li></ul> <p>After saving these changes, you'll be prompted for two final pieces of information:</p> <ul><li>The application type: You can select between <code>Web application</code>, <code>Android</code>, <code>Chrome App</code>, <code>iOS</code>, or <code>Other</code>. What you choose here won't affect DreamFactory's behavior, so be sure to choose the type most suitable to your specific application.</li> <li>Restrictions: This oddly-named field asks you to supply an authorized JavaScript origin URL and/or an authorized redirect URI. The redirect URI is crucial here because it is the destination where Google will send the authorization code following successful authentication. This code must be intercepted by your application and forwarded on to DreamFactory to complete the process and generate the session token (JWT). If you don't yet understand exactly how this will work, I suggest just reading on and returning to this configuration screen after seeing an example later in this section.</li></ul> <p>After saving your changes, you're ready to configure DreamFactory's OpenID Connect connector!</p> <h3 id="configuring-dreamfactory"><a href="#configuring-dreamfactory" aria-hidden="true" class="header-anchor">#</a> Configuring DreamFactory</h3> <p>DreamFactory's authentication connectors are found in the same location as the standard API connectors. To view them, login to your DreamFactory instance and navigate to the <code>Services</code> tab. Choose <code>Create</code>, and in the dropdown that appears, select <code>OAuth</code> and finally <code>OpenID Connect</code>. You'll be presented with the following initial configuration screen:</p> <p><img src="/images/04/openid/openid-connect-info-df.png" width="600"></p> <ul><li><strong>Name</strong>: The name will form part of your API URL, so you'll want to use a lowercase string with no spaces or special characters. Further, you'll want to typically choose something which allows you to easily identify the API's purpose. For instance for your Google-backed OpenID Connect authentication API you might choose a name such as <code>google</code> or <code>openid</code>. Keep in mind a lowercased, alphanumeric name is required.</li> <li><strong>Label</strong>: The label is used for referential purposes within the administration interface and system-related API responses. You can use something less terse here, such as &quot;Google OpenID API&quot;.</li> <li><strong>Description</strong>: Like the label, the description is used for referential purposes within the administration interface and system-related API responses.</li> <li><strong>Active</strong>: This determines whether the API is active. By default it is set to active however if you're not yet ready to begin using the API or would like to later temporarily disable it, just return to this screen and toggle the checkbox.</li></ul> <p>With these fields completed, click the <code>Config</code> tab to finish configuration. On this screen you'll be presented with a number of fields, including:</p> <ul><li><strong>Default Role</strong>: DreamFactory can automatically assign a default role (learn more about roles <a href="http://guide.dreamfactory.com/docs/chapter03.html#creating-a-role" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>) to a user following successful login. You can identify that role here. If you want to more selectively grant roles, see the <strong>Role per App</strong> field, introduced below.</li> <li><strong>Discovery Document Endpoint</strong>: If your identity provider offers a discovery document endpoint, adding it here will be the <em>fastest</em> way to configure your OpenID Connect connector. This is because doing so will automatically configure the rest of the fields, requiring you to only additionally supply the client ID, client secret, and redirection URL.</li> <li><strong>Authorization Endpoint</strong>: This endpoint authorizes access to a protected resource such as the resource owner's identity. It will be invoked following the resource owner's successful login and authorization for the requester to access said protected resource.</li> <li><strong>Token Endpoint</strong>: The token endpoint is contacted by the client after receiving an authorization code from the authorization endpoint. The client passes this authorization code to the token endpoint where if validated, tokens are returned to the client.</li> <li><strong>User Info Endpoint</strong>: This endpoint can be contacted by the client for reason of retrieving information about the logged-in user's claims (name, email, etc.).</li> <li><strong>Validate ID Token</strong>: By checking this field, DreamFactory will validate the ID token by performing tasks such as checking that the encryption algorithm used to encrypt the token matches that specified by the OpenID provider, validating the token signature, and validating the token claims.</li> <li><strong>JWKS URI</strong>: This identifies the JSON Web Key Set (JWKS) URI. The JWKS contains the set of public keys used for JWT verification. For instance Google defines this URI as <code>https://www.googleapis.com/oauth2/v3/certs</code>.</li> <li><strong>Scopes</strong>: Scopes identify the level of restricted access requested by the client. For instance this might be some user profile information such as the name and e-mail address, or it might be access to an otherwise private service such as the user's Google Calendar. Using this field you'll define your scopes in comma-delimited format, such as <code>openid,email,profile</code>.</li> <li><strong>Client ID</strong>: Along with the client secret (introduced next), the client ID forms one part of the credentials pair used by the client to interact with the identity provider. You'll obtain the client ID when creating a developer's account with the desired identity provider.</li> <li><strong>Client Secret</strong>: The client secret is used in conjunction with the client ID to authenticate with the identity provider. You'll receive this secret along with the client ID when creating a developer's account with the identity provider.</li> <li><strong>Redirect URL</strong>: Perhaps more than any other, the OpenID redirect URL causes considerable confusion amongst developers when creating an OpenID flow. This is because a bit of additional coding <em>within the application</em> is required in order to complete the OpenID flow. Upon successful authentication and authorization on behalf of the identity provider, this URL will be contacted with a set of parameters that the URL's script must then forward on to DreamFactory. DreamFactory will contact the identity provider one last time to verify the parameters, and then return a session token (JWT) to the script that initiated the forwarding. Without this additional sequence it would not be possible for your custom application to obtain the JWT! Don't worry though, later in this section we provide an example script demonstrating this process.</li> <li><strong>Role per App</strong>: If assigning a blanket role through the <strong>Default Role</strong> setting is not desired, you can instead use this setting to assign roles on a per application basis.</li></ul> <p>After configuring these settings, press <code>Save</code> to persist the changes. Next we'll complete the configuration process by creating a script responsible for completing the OAuth callback and generating the session token (JWT)</p> <h3 id="the-openid-authentication-process"><a href="#the-openid-authentication-process" aria-hidden="true" class="header-anchor">#</a> The OpenID Authentication Process</h3> <p>Recall when configuring Google's OpenID settings you added the redirection URI:</p> <p><img src="/images/04/openid/google-authorized-redirect-uris.png" width="600"></p> <p>This endpoint is responsible for intercepting the OAuth callback parameters which need to be forwarded onto DreamFactory in order to generate the session token. The following example PHP script does exactly this, and then returns the JSON object containing the JWT and other user profile data such as the name and e-mail address. Here's the script:</p> <pre><code>&lt;?php

$queryString = $_SERVER['QUERY_STRING'];

# Create a connection
$url = 'https://example.com/api/v2/user/session?oauth_callback=true&amp;' . $queryString;
$ch = curl_init($url);

# Setting our options
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

# Get the response
$response = curl_exec($ch);
curl_close($ch);

$json = json_decode($response);

var_dump($json);
</code></pre> <p>And here is the formatted JSON output:</p> <pre><code>object(stdClass)#1 (12) { 
    [&quot;session_token&quot;]=&gt; string(353) 
    &quot;JWT_TOKEN_HERE&quot; 
    [&quot;id&quot;]=&gt; int(9) 
    [&quot;name&quot;]=&gt; string(13) &quot;Jason Gilmore&quot; 
    [&quot;first_name&quot;]=&gt; string(5) &quot;Jason&quot; 
    [&quot;last_name&quot;]=&gt; string(7) &quot;Gilmore&quot; 
    [&quot;email&quot;]=&gt; string(37) &quot;jason.gilmore+google@dreamfactory.com&quot; 
    [&quot;is_sys_admin&quot;]=&gt; bool(false) 
    [&quot;last_login_date&quot;]=&gt; string(19) &quot;2019-07-10 15:04:45&quot; 
    [&quot;host&quot;]=&gt; string(20) &quot;dreamfactory-demo-30&quot; 
    [&quot;oauth_token&quot;]=&gt; string(129) &quot;OAUTH_TOKEN_HERE&quot; 
    [&quot;id_token&quot;]=&gt; string(1245) &quot;ID_TOKEN_HERE&quot; 
}
</code></pre> <p>You'll add a script like this to your application in order to retrieve the JWT (defined within the <code>session_token</code> attribute) and subsequently pass that JWT along with future API requests. So now that all of the pieces to the puzzle are in place, what does the authentication workflow look like? Let's walk through the entire process.</p> <h4 id="step-1-user-clicks-on-authentication-link"><a href="#step-1-user-clicks-on-authentication-link" aria-hidden="true" class="header-anchor">#</a> Step #1. User clicks on authentication link</h4> <p>To create the authentication link, you'll use this URL:</p> <pre><code>https://YOUR_DREAMFACTORY_SERVER.com/api/v2/user/session?service=YOUR_SERVICE_NAME
</code></pre> <p>Of course you'll need to replace <code>YOUR_DREAMFACTORY_SERVER</code> with your DreamFactory server's domain name, and <code>YOUR_SERVICE_NAME</code> with the name of the OpenID service you created inside DreamFactory.</p> <h4 id="step-2-login-using-the-designated-identity-provider"><a href="#step-2-login-using-the-designated-identity-provider" aria-hidden="true" class="header-anchor">#</a> Step #2. Login Using the Designated Identity Provider</h4> <p>Once the user clicks on this link he will be redirected to the authentication form, which when using Google OpenID looks like this:</p> <p><img src="/images/04/openid/google-email-prompt.png" width="500"></p> <p>After entering your e-mail address and password, the user will next be prompted to confirm permission for the client to access a specified set of resources:</p> <p><img src="/images/04/openid/google-allow-deny.png" width="500"></p> <h4 id="step-3-dreamfactory-generates-the-session-key"><a href="#step-3-dreamfactory-generates-the-session-key" aria-hidden="true" class="header-anchor">#</a> Step #3. DreamFactory Generates the Session Key</h4> <p>Once the user clicks <code>Allow</code>, the OpenID provider will return the authorization information <em>to the redirect URL</em>. At this point the script associated with the redirect URL will forward that information on to DreamFactory (see above script), and DreamFactory will return the session token to the script, at which point your application can persist it and include it with subsequent requests.</p> <h2 id="authenticating-with-okta"><a href="#authenticating-with-okta" aria-hidden="true" class="header-anchor">#</a> Authenticating with Okta</h2> <p><a href="https://www.okta.com" target="_blank" rel="noopener noreferrer">Okta<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is a powerful and popular identity management solution used by thousands of businesses across the globe. Many developers wish to integrate Okta into their application authentication infrastructure, and DreamFactory offers a straightforward solution for doing so. In this tutorial we'll guide you through the configuration process.</p> <h3 id="configuring-okta"><a href="#configuring-okta" aria-hidden="true" class="header-anchor">#</a> Configuring OKTA</h3> <p>Begin by creating an Okta account at <a href="https://www.okta.com" target="_blank" rel="noopener noreferrer">https://www.okta.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> if you haven't already done so. Once logged-in, open the <code>Admin</code> section:</p> <p><img src="/images/04/okta/3453a85c_2019.18.04..png" width="800"></p> <p>Next, you'll add a new application:</p> <p><img src="/images/04/okta/createapp.jpeg" width="800"></p> <p>Be sure to select SAML 2.0:</p> <p><img src="/images/04/okta/ec143ec9_2019.18.04..png" width="800"></p> <p>Next, we'll configure the application:</p> <p><img src="/images/04/okta/okta-app-first-conf.jpeg" width="800"></p> <p>Open <code>Setup instructions</code>, making sure you don't close the tab containing these instructions as we'll return to them later:</p> <p><img src="/images/04/okta/805a39fb_2019.18.04..png" width="800"></p> <h3 id="configuring-dreamfactory-2"><a href="#configuring-dreamfactory-2" aria-hidden="true" class="header-anchor">#</a> Configuring DreamFactory</h3> <p>Next, we'll configure DreamFactory to support the new OKTA application. Begin by signing into DreamFactory as an administrator, and then navigate to the <code>Roles</code> section and configure a role for the users who will sign in via Okta SSO. Here's an example of a role defining access to all APIs (not typical but nonetheless illustrative):</p> <p><img src="/images/04/okta/role.jpeg" width="800"></p> <p>With the role defined, navigate to the <code>Apps</code> tab and create a new API key which will be associated with this role:</p> <p><img src="/images/04/okta/4d5147a6_2019.18.04..png" width="800"></p> <h4 id="creating-the-saml-2-0-service"><a href="#creating-the-saml-2-0-service" aria-hidden="true" class="header-anchor">#</a> Creating the SAML 2.0 Service</h4> <p>With the role and API key defined, it's time to create the SAML 2.0 service that will connect your Okta application to DreamFactory. Navigate to <code>Services &gt; Create</code>, choose <code>SSO</code>, and finally <code>SAML 2.0</code>:</p> <p><img src="/images/04/okta/269c5d5d_2019.18.04..png" width="800"></p> <p>Begin by configuring the <code>Info</code> tab:</p> <p><img src="/images/04/okta/74a971ed_2019.18.04..png" width="800"></p> <p>Next, configure the <code>Config</code> tab, filling in the fields with the information found in Okta's <code>Setup instructions</code> page:</p> <p><img src="/images/04/okta/374044b6_2019.18.04..png" width="800"></p> <p>Save these changes, and navigate to the <code>API Docs</code> tab. Here you can see new Okta endpoints:</p> <p><img src="/images/04/okta/30050024_2019.18.04..png" width="800"></p> <h2 id="adding-okta-users-to-the-dreamfactory-application"><a href="#adding-okta-users-to-the-dreamfactory-application" aria-hidden="true" class="header-anchor">#</a> Adding Okta Users to the DreamFactory Application</h2> <p>With your Okta application created and DreamFactory configured, return to Okta, and in the Admin app navigate to the <code>Application</code> page:</p> <p><img src="/images/04/okta/b72eb33c_2019.18.04..png" width="800"></p> <p>Select our DreamFactory application in the list:</p> <p><img src="/images/04/okta/038b771f_2019.18.04..png" width="800"></p> <p>Assign this application to the People and Groups who will use it:</p> <p><img src="/images/04/okta/345418e2_2019.18.04..png" width="800"></p> <p>Go to the <code>General</code> tab and click the <code>Edit</code> button:
=
</p><p><img src="/images/04/okta/a765987e_2019.18.04..png" width="800"></p><p></p> <p>Change <code>Single sign on URL</code> and <code>Audience URI (SP Entity ID)</code> to the values presented in DreamFactory's Okta API documentation, and then save the changes:</p> <p><img src="/images/04/okta/1e2f05e7_2019.18.04..png" width="800"></p> <h4 id="application-configuration"><a href="#application-configuration" aria-hidden="true" class="header-anchor">#</a> Application configuration</h4> <p>We're almost done! Now we can sign in via Okta by going to the service's /sso endpoint. In our example application we assign <code>Sign in with OKTA</code> button to this endpoint. Clicking this button, DreamFactory can return the <code>X-DreamFactory-Session-Token</code>, which we have to use for comunication with DreamFactory:</p> <p><img src="/images/04/okta/1a0f8d6f_2019.18.04..png" width="800"></p> <p>But how does DreamFactory know where send the token? We have to configure our <code>Relay State</code> for this purpose. Open the <code>Services</code> tab and select your OKTA SSO service. Navigate to the <code>Config</code> tab and update the <code>Relay State</code> field URL which will contain the token returned from DreamFactory. Our example site hosted on <code>http://127.0.0.1:5500</code> will pass token to the <code>/hello.html</code> page:</p> <p><img src="/images/04/okta/a74c1d41_2019.18.04..png" width="800"></p> <p>DreamFactory will replace the <code>_token_</code> with a real <code>X-DreamFactory-Session-Token</code>. You might then use JavaScript to persist this token to local storage, or use server-side languages to do the same using cookies:</p> <p><img src="/images/04/okta/a11d4aaf_2019.18.04..png" width="800"></p> <p>Now we can communicate with DreamFactory by including <code>X-DreamFactory-Session-Token</code> and <code>X-DreamFactory-API-Key</code> in the request header:</p> <p><img src="/images/04/okta/123452d6_2019.18.04..png" width="800"></p> <p>Don't forget add your application to the CORS interface via <code>Config &gt; CORS</code>. Our example CORS configuration allows any requests to all DreamFactory endpoints with any headers. You can configure it to be more secure:</p> <p><img src="/images/04/okta/6a3f1331_2019.18.04..png" width="800"></p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/13.b04c4acb.js" defer></script><script src="/assets/js/app.6b877e42.js" defer></script>
  </body>
</html>
